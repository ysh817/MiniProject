<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="UserInfo">
	<resultMap type="com.enuri.myweb.vo.userinfo.UserInfo" id="UserInfoMap">
	<!-- 이게 곧 vo -->
		<result property="user_id" column="USER_ID"/>
		<result property="user_pw" column="USER_PW"/>
		<result property="user_pw2" column="USER_PW2"/>
		<result property="user_name" column="USER_NAME"/>
		<result property="user_email" column="USER_EMAIL"/>
		<result property="user_gender" column="USER_GENDER"/>
		<result property="crt_dt" column="CRT_DT"/>
		<result property="user_code" column="USER_CODE"/>
		

	</resultMap>
	
	<!-- <![CDATA[   ]]>  -->
	
	<select id="getAllUserInfo" resultMap="UserInfoMap">
		SELECT *
		FROM USER_INFO
	</select>	
	<select id="getAllUserList" resultMap="UserInfoMap">
		SELECT *
		FROM USER_INFO
		ORDER BY USER_CODE
	</select>	
	
	
	<select id="getUserInfo" parameterType="UserInfo" resultMap="UserInfoMap">
		SELECT *
		FROM USER_INFO
		WHERE USER_ID = #{user_id} 
		AND USER_PW = #{user_pw}
	</select>	
	<select id="getUser" parameterType="UserInfo" resultMap="UserInfoMap">
		SELECT *
		FROM USER_INFO
		WHERE USER_ID = #{user_id} 
		AND USER_PW = #{user_pw}
	</select>
	
	<select id="login" parameterType="UserInfo" resultMap="UserInfoMap">
		SELECT USER_ID, USER_PW
		FROM USER_INFO
		WHERE USER_ID = #{user_id} 
		AND USER_PW = #{user_pw}
	</select> 
	<!--  insert-param -->
	<!-- select-result -->

<!-- <insert id="joinUser" parameterType="UserInfo" >
		INSERT INTO USER_INFO (USER_ID, USER_PW ,USER_PW2, 
		USER_NAME, USER_EMAIL, USER_GENDER,TO_CHAR(CRT_DT,'YYYY-MM-DD hh:mm'), USER_CODE)
		
		VALUES(#{user_id}, #{user_pw},#{user_pw2}, 
		#{user_name}, #{user_email}, #{user_gender}, 
		now(),  
		USER)
	
	
	</insert>
	-->
	 <insert id="joinUser" parameterType="UserInfo" >
		INSERT INTO USER_INFO 
		( USER_ID, USER_PW ,USER_PW2, 
		USER_NAME, USER_EMAIL, USER_GENDER,
		<!-- DATE_FORMAT(TA.USE_START_DATE, '%Y-%m-%d') AS CRT_DT -->
		CRT_DT, USER_CODE )
		
		VALUES
		( #{user_id}, #{user_pw},#{user_pw2}, 
		#{user_name}, #{user_email}, #{user_gender},
		#{crt_dt} ,'user' )

	
	</insert> 
	 <update id="modifyUser" parameterType="UserInfo" >
		UPDATE USER_INFO 
		SET USER_NAME=#{user_name}, 
		USER_PW=#{user_pw},USER_PW2=#{user_pw2} 
		WHERE USER_ID=#{user_id}
	</update>
	
	<select id="getAdminModifyUserInfo" parameterType="String" resultMap="UserInfoMap">
		SELECT *
		FROM USER_INFO
		WHERE USER_ID = #{user_id} 
	</select>
	  <update id="adminModifyUser" parameterType="UserInfo" >
		UPDATE USER_INFO 
		SET USER_NAME=#{user_name}, 
		USER_PW=#{user_pw},USER_PW2=#{user_pw}	
		WHERE USER_ID=#{user_id}
	</update>

	<select id="getIDExist" parameterType="String" resultMap="int">
		SELECT COUNT(*)
		FROM USER_INFO
		WHERE USER_ID = #{user_id} 
	</select>
	
	<!-- <delete id="deleteUser" parameterType="UserInfo">
		DELETE 
	
	</delete> -->
	
	<!-- logout, 비밀번호변경?,  -->
	
</mapper>
	